<!-- // main for a image gallery which will display images from a local file  -->
<!-- // new images will transition in from the top, like rain drops  and old ones should transtion out -->
<!-- Philip Ong   Jan 23,2017-->
<!DOCTYPE html>
<html>
<head>
	<title>rain drops page </title>
	<link rel="stylesheet" href="style.css">
	<script src='jquery-3.1.1.min.js'></script>
	<!-- using this transit library will result in better for bright sign performace  -->
	<script src='jquery.transit.js'></script>
	<script src='functions.js'></script>
	<script src='CacheImages.js'></script>
</head>

<body>
	
	<div id="main-container">
	
		<div id="Centre-container">
		<!-- drop -->
		<!-- middle left -->
			<img id="centreImg6" class="Middle" src="http://192.168.2.239/RoyalityFree/01.jpg" alt="" >
		<!-- middle -->
			<img id="centreImg5" class="Middle" src="http://192.168.2.239/RoyalityFree/02.jpg" alt="" >
		<!-- top right -->
			<img id="centreImg4" class="Middle" src="http://192.168.2.239/RoyalityFree/03.jpg" alt="">
		
		<!-- fade1 -->
		<!-- middle left -->
			<img id="centreImg3" class="LeftMiddle" src="http://192.168.2.239/RoyalityFree/04.jpg" alt="" >
		<!-- middle -->
			<img id="centreImg2" class="Middle" src="http://192.168.2.239/RoyalityFree/05.jpg" alt="" >
		<!-- top right -->
			<img id="centreImg1" class="RightMiddle" src="http://192.168.2.239/RoyalityFree/06.jpg" alt="" >
			
		<!-- overlay -->	
			<img id="overlay2" class="overlay" src="mask.png" >
			
		</div>
		
	</div>
	

	<script id= 'code'>
	{
		var imgPath  = "http://192.168.2.239/RoyalityFree/";
		var totalDuration = 3000; //total time between slides 
		var transitDuration = 6000; //the duration for the transition 
		var waitDuration = 500; //the duration for the wait between transition 
		var UpdateInterval = 8000; //the wait between the each check  
		var TransitionState=0;
		var xLeftPos = -540;// 500
		var xRightPos = 500;
		var yTargetPos = 100;
		var yTargetPos2 = 140;
		
		
		var currentImg=0;
		var maxImages=12;
		var xOffset = [-50,50];
		var Connected = false; 
		
		//the start up function 
		$(function (){
			var ImageFound=false;
			console.log("initializing");
			<!-- SetImageArray(maxImages); -->
			PreLoadImages(maxImages);
			
			<!-- intial setup -->
			SetValues('#centreImg6',xLeftPos,yTargetPos2-10,-10,1,0);
			SetValues('#centreImg5',0,yTargetPos,15,1,0);
			SetValues('#centreImg4',xRightPos,10,-35,1,0);
			
			setTimeout(Update, 1000);
			
			Connected = loadedImages ; 
		});
		
		<!----- Main function reccursively calling itself   --->
		function Update()
		{
			if (Connected)
			{
				FadeTransition();
			}
			else 
			{
				RefreshCheck();
			}
		}
		
		function FadeTransition()
		{
			ChangeOut();
			
			
		}
		
		<!----- Transition in for the new images  --->
		function DropIn()
		{
			if (TransitionState == 0)
			{

				rainDropTransition('#centreImg3',0,yTargetPos2,-10,totalDuration,500);
				ChangeImg('#centreImg3',imgArray[currentImg]);
			}
			else if (TransitionState == 1)
			{

				rainDropTransition('#centreImg2',0,yTargetPos,15,totalDuration,500);
				ChangeImg('#centreImg2',imgArray[currentImg]);
			}
			else if (TransitionState == 2)
			{
				
				rainDropTransition('#centreImg1',0,0,-35,totalDuration,500);
				ChangeImg('#centreImg1',imgArray[currentImg]);
			}
			
			<!----- from main --->
			NextImage();

			if (TransitionState == 2)
			{
				TransitionState = 0;	
				<!-- PreLoadImages(maxImages); -->
				LoadSetImages(maxImages,currentImg,3,Math.random())
			}
			else 
				TransitionState = Math.min(TransitionState+1, 2);
			
			if (Connected)
			{
				setTimeout(FadeTransition,totalDuration);
			}
			else 
			{
				RefreshCheck();
			}
			
		}		
		
		<!----- Setup Transition out for the old images  --->
		function ChangeOut()
		{
			var tempImage=returnPreviousInt(1,currentImg,maxImages);
			
			if (TransitionState == 0)
			{
				SetValues('#centreImg3',0,-300,-10,0.35,0);
				
				$('#centreImg3').css('z-index', 4); 
				$('#centreImg2').css('z-index', 2); 
				$('#centreImg1').css('z-index', 3); 
				ChangeImg('#centreImg6',imgArray[tempImage]);
				<!-- SetPosition('#centreImg6',xLeftPos,yTargetPos2-8,-10,0); -->
			}
			else if (TransitionState == 1)
			{
				SetValues('#centreImg2',0,-300,15,0.35,0);
			
				$('#centreImg3').css('z-index', 3);
				$('#centreImg2').css('z-index', 4); 
				$('#centreImg1').css('z-index', 2); 
				ChangeImg('#centreImg5',imgArray[tempImage]);
				<!-- SetPosition('#centreImg5',0,yTargetPos,15,0); -->
			}
			else if (TransitionState == 2)
			{
				SetValues('#centreImg1',-70,-350,0,0.3,0);
				
				$('#centreImg3').css('z-index', 2); 
				$('#centreImg2').css('z-index', 3); 
				$('#centreImg1').css('z-index', 4); 
				ChangeImg('#centreImg4',imgArray[tempImage]);
				<!-- SetPosition('#centreImg4',xRightPos,15,-35,0); -->
			}
			
			setTimeout(DropIn,waitDuration);
		}
		
		function returnPreviousInt()
		{
			if (currentImg-3<0)
			{
			<!-- when the new number will be less than 0 -->
				return maxImages + (currentImg-3);
			}
			else 
			{
				return currentImg-3;
			}
		}
		
		//the next image in the list 
		function NextImage()
		{
			var ImageFound=false;
			var previousImg_i = currentImg;
			if (currentImg +1== maxImages)
				currentImg = 0;	
			else 
				currentImg = Math.min(currentImg+1, maxImages);

			if (currentImg==0)
			{// if the current image has been reset 
				<!-- PreLoadImages(maxImages); -->
				if (loadedImages)
				{
					Connected = true; 
				}
				else 
				{
					Connected = false; 
				}
			}
		}
		
		function RefreshCheck()
		{
			PreLoadImages(maxImages,Math.random());
			if (Connected)
			{
				setTimeout(Update,1000);
			}
			else 
			{
				setTimeout(RefreshCheck, UpdateInterval);
			}
		}
		
		function ImageLoaded()
		{
			console.log("Image loaded called");
			Connected=true;
		}
		
		function FailedToLoad()
		{
			console.log("FailedToLoad called");
			Connected=false;
		}
		
		
	}
	</script>
</body>

</html>