<!-- // main for a image gallery which will display images from a local file  -->
<!-- // new images will transition in from the top, like rain drops  and old ones should transtion out -->
<!-- Philip Ong   Jan 23,2017-->
<!DOCTYPE html>
<html>
<head>
	<title>rain drops page </title>
	<link rel="stylesheet" href="style.css">
	<script src='jquery-3.1.1.min.js'></script>
	<!-- using this transit library will result in better for bright sign performace  -->
	<script src='jquery.transit.js'></script>
	<script src='functions.js'></script>
	<script src='CacheImages.js'></script>
</head>

<body>
	<!----- body area ----->
	<div id="main-container">
		<div id="Centre-container">
		<!-- Shadow  -->
			<img id="ShadowBackLeft" class="MiddleShadow" src="DropShadow.png" >
			<img id="ShadowBack" class="MiddleShadow" src="DropShadow.png" >
			<img id="ShadowBackRight" class="MiddleShadow" src="DropShadow.png" >
		
		<!-- Back images  -->
			<img id="centreLeft" class="LeftMiddle" src="http://192.168.2.239/RoyalityFree/01.jpg" alt="" >
			<img id="centreMiddle" class="Middle" src="http://192.168.2.239/RoyalityFree/02.jpg" alt="" >
			<img id="centreRight" class="RightMiddle" src="http://192.168.2.239/RoyalityFree/03.jpg" alt="">
		<!-- Shadow  -->
			<img id="ShadowLeft" class="LeftShadow" src="DropShadow.png" >
			<img id="ShadowMid" class="MiddleShadow" src="DropShadow.png" >
			<img id="ShadowRight" class="RightShadow" src="DropShadow.png" >
		
		<!-- Front images -->
			<img id="leftTopMiddle" class="LeftMiddle" src="http://192.168.2.239/RoyalityFree/04.jpg" alt="" >
			<img id="middleTopMiddle" class="Middle" src="http://192.168.2.239/RoyalityFree/05.jpg" alt="" >
			<img id="rightTopMiddle" class="RightMiddle" src="http://192.168.2.239/RoyalityFree/06.jpg" alt="" >
			
		<!-- overlay -->	
			<img id="overlayContainer" class="overlayClass" src="mask.png" >
		</div>
		<!----- end body area ----->
	</div>
	

	<script id= 'code'>
	{/// begin code area  
		var totalDuration = 4000; //total time between slides 
		var transitDuration = 6000; //the duration for the transition 
		var waitDurationP1 = 5; //for the wait between the setting of transitions 
		var waitDurationP2 = 5; //for the wait between transition 
		var UpdateInterval = 8000; //the wait between the each check  
		var TransitionState=0;
		
		var xLeftPos = -540;// 500
		var xRightPos = 500;
		var yTargetPos = 100;
		var yTargetPos2 = 140;
		var xOffset = [-50,50];
		var currentImg=0;
		var maxDynamicImages=12;
		var maxImages=22;
		var Connected = false; 
		var PrePos1 = 0;
		var PrePos2 = 0;
		var PrePos3 = 0;
		
		//the start up function 
		$(function (){
			var ImageFound=false;
			console.log("initializing");
			PreLoadImages(maxDynamicImages);
			
			<!-- intial setup -->
			
			SetValues('#ShadowBackLeft',xLeftPos,yTargetPos2-10,-10,1,0);
			SetValues('#ShadowBack',0,yTargetPos,15,1,0);
			SetValues('#ShadowBackRight',xRightPos,10,-35,1,0);
			
			SetValuesMin('#centreLeft',yTargetPos2-10,-10);
			SetValuesMin('#centreMiddle',yTargetPos,15);
			SetValuesMin('#centreRight',10,-35);
			
			$('#centreLeft').css('z-index', 2); 
			$('#centreMiddle').css('z-index', 2); 
			$('#centreRight').css('z-index', 2); 
				
			
			setTimeout(Update, 1000);
			
			Connected = loadedImages ; 
		});
		
		<!----- Transition for dropping in from the transition state --->
		function DropIn()
		{
			var tempImage=returnPreviousInt(3,currentImg,maxImages);// 22 because there are 22 images
			var randomAngle=RandomNumber(0,60,30);
			if (TransitionState == 0)
			{// -10 15 -35
				PrePos1=randomAngle;
				rainDropTransition('#leftTopMiddle',yTargetPos2,randomAngle,totalDuration);//Regular outside transition
				ChangeImg('#leftTopMiddle',imgArray[currentImg]);//Change the front image to current

				rainDropTransition('#ShadowLeft',yTargetPos2,randomAngle,totalDuration);
			}
			else if (TransitionState == 1)
			{
				PrePos2=randomAngle;
				rainDropTransition('#middleTopMiddle',yTargetPos,randomAngle,totalDuration);//Regular outside transition
				ChangeImg('#middleTopMiddle',imgArray[currentImg]);//Change the front image to current
			
				rainDropTransition('#ShadowMid',yTargetPos,randomAngle,totalDuration);
			}
			else if (TransitionState == 2)
			{	
				PrePos3=randomAngle;
				rainDropTransition('#rightTopMiddle',0,randomAngle,totalDuration);//Regular outside transition
				ChangeImg('#rightTopMiddle',imgArray[currentImg]);//Change the front image to current
				
				rainDropTransition('#ShadowRight',10,randomAngle,totalDuration);
			}
			
			<!----- from main --->
			NextImage();// only transition to next image after we have the image numbers set 

			if (TransitionState == 2)
			{
				TransitionState = 0;	
				LoadSetImages(maxDynamicImages,currentImg,3,Math.random());
			}
			else 
			{
				TransitionState = Math.min(TransitionState+1, 2);
			}
				
			
			if (Connected)
			{
				setTimeout(TransitionOut,totalDuration);
			}
			else 
			{
				RefreshCheck();
			}
			
		}		
		
		<!----- Setup the images for the transition out 1st part --->
		function TransitionOut()
		{
			var randomAngle=RandomNumber(0,60,30);
			var tempImage=returnPreviousInt(3,currentImg,maxImages);// 22 because there are 22 images 
			
			if (TransitionState == 0)
			{	
				ChangeImg('#centreLeft',imgArray[tempImage]);//Change the back image to the previous
				SetValuesMin('#leftTopMiddle',-500,randomAngle);//set the front value  300 0.35
				SetValuesMin('#ShadowLeft',-500,randomAngle);//set front shadow values 
				
				// set z index of the shadows
				$('#ShadowLeft').css('z-index', 4); 
				$('#ShadowMid').css('z-index', 2); 
				$('#ShadowRight').css('z-index', 3); 
				
				//set z index of pictures
				$('#leftTopMiddle').css('z-index', 4); 
				$('#middleTopMiddle').css('z-index', 2); 
				$('#rightTopMiddle').css('z-index', 3); 
			}
			else if (TransitionState == 1)
			{				
				ChangeImg('#centreMiddle',imgArray[tempImage]);//Change the back image to the previous	
				SetValuesMin('#middleTopMiddle',-600,randomAngle);//set the front value 
				SetValuesMin('#ShadowMid',-600,randomAngle);//set front shadow values 
						
				// set z index of the shadows
				$('#ShadowLeft').css('z-index', 3); 
				$('#ShadowMid').css('z-index', 4); 
				$('#ShadowRight').css('z-index', 2); 
				//set z index of pictures
				$('#leftTopMiddle').css('z-index', 3);
				$('#middleTopMiddle').css('z-index', 4); 
				$('#rightTopMiddle').css('z-index', 2); 
			}
			else if (TransitionState == 2)
			{	
				ChangeImg('#centreRight',imgArray[tempImage]);//Change the back image to the previous			
				
				SetValuesX('#rightTopMiddle',-70,-700,randomAngle);//set the front value 450 0.3
				SetValuesMin('#ShadowRight',-700,randomAngle);//set front shadow values 0.2

				// set z index of the shadows
				$('#ShadowLeft').css('z-index', 2); 
				$('#ShadowMid').css('z-index', 3); 
				$('#ShadowRight').css('z-index', 4); 
				
				$('#leftTopMiddle').css('z-index', 2); 
				$('#middleTopMiddle').css('z-index', 3); 
				$('#rightTopMiddle').css('z-index', 4); 
			}
			
			setTimeout(TransitionOutp2,waitDurationP1);
		}
		
		<!----- Setup the images for the transition out 2nd part --->
		function TransitionOutp2()
		{
			var randomAngle=RandomNumber(0,60,30);
			var tempImage=returnPreviousInt(3,currentImg,maxImages);// 22 because there are 22 images 
			
			if (TransitionState == 0)
			{
				SetValuesMin('#centreLeft',yTargetPos2-10,PrePos1);// set the back picture value 
				SetValues('#ShadowBackLeft',xLeftPos,yTargetPos2-10,PrePos1,1,0);
			}
			else if (TransitionState == 1)
			{				
				SetValuesMin('#centreMiddle',yTargetPos,PrePos2);// set the back picture value 
				SetValues('#ShadowBack',0,yTargetPos,PrePos2,1,0);
				
			}
			else if (TransitionState == 2)
			{
				SetValuesMin('#centreRight',10,PrePos3);// set the back picture value 
				SetValues('#ShadowBackRight',xRightPos,10,PrePos3,1,0);
			}
			
			setTimeout(DropIn,waitDurationP2);
		}
		
		//the next image in the list 
		function NextImage()
		{
			var ImageFound=false;
			var previousImg_i = currentImg;
			if (currentImg +1== maxImages)
				currentImg = 0;	
			else 
				currentImg = Math.min(currentImg+1, maxImages);

			if (currentImg==0)
			{// if the current image has been reset 
				if (loadedImages)
				{
					Connected = true; 
				}
				else 
				{
					Connected = false; 
				}
			}
		}
		
		<!----- Main function reccursively calling itself  ---->
		function Update()
		{
			if (Connected)
			{
				TransitionOut();
			}
			else 
			{
				RefreshCheck();
			}
		}
		
		//the check which will 
		function RefreshCheck()
		{
			PreLoadImages(maxDynamicImages,Math.random());
			if (Connected)
			{
				setTimeout(Update,1000);
			}
			else 
			{
				setTimeout(RefreshCheck, UpdateInterval);
			}
		}
		
		//loaded image functions 
		function ImageLoaded()
		{
			//console.log("Image loaded called");
			Connected=true;
		}
		
		function FailedToLoad()
		{
			console.log("FailedToLoad called");
			Connected=false;
		}
		
		
	}/// end code area
	/// help me I'm... just a quote from pentagon wars
	</script>
</body>
</html>